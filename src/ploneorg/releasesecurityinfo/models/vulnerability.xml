<?xml version="1.0" ?>
<model xmlns="http://namespaces.plone.org/supermodel/schema"
       xmlns:form="http://namespaces.plone.org/supermodel/form"
       xmlns:security="http://namespaces.plone.org/supermodel/security"
       xmlns:marshal="http://namespaces.plone.org/supermodel/marshal"
       xmlns:users="http://namespaces.plone.org/supermodel/users"
       xmlns:lingua="http://namespaces.plone.org/supermodel/lingua"
       xmlns:i18n="http://namespaces.zope.org/i18n"
       i18n_domain="ploneorg.releasesecurityinfo">

<schema>

    <!-- field definitions -->
    <field name="vulnerability_type"
           type="zope.schema.TextLine"
           form:mode="z3c.form.interfaces.IAddForm:input z3c.form.interfaces.IEditForm:input"
    >
      <title i18n:translate="">Vulnerability type</title>
      <description i18n:translate="">General vulnerability classification</description>
      <required>False</required>
    </field>

    <field name="details"
           type="zope.schema.Text"
           security:write_permission="cmf.ManagePortal"
           security:read_permission="zope2.View"
    >
      <title i18n:translate="">Details</title>
      <description i18n:translate="">Full description of vulnerability</description>
      <required>False</required>
    </field>

    <field name="current_status"
           type="zope.schema.Text"
           security:write_permission="cmf.ManagePortal"
           security:read_permission="zope2.View"
    >
      <title i18n:translate="">Current status</title>
      <description i18n:translate="">Current status of our response to this vulnerability</description>
      <required>False</required>
    </field>

    <field name="date_reported"
           type="zope.schema.Date"
    >
      <title i18n:translate="">Date reported</title>
      <description i18n:translate="">Date this vulnerability was reported</description>
      <required>False</required>
    </field>

    <field name="date_patched"
           type="zope.schema.Date"
    >
      <title i18n:translate="">Date patched</title>
      <description i18n:translate="">Date this vulnerability was patched</description>
      <required>False</required>
    </field>

    <field name="reported_by"
           type="zope.schema.List"
    >
      <title>Reported by</title>
      <description i18n:translate="">Who found this (one per line)</description>
      <value_type type="zope.schema.TextLine">
        <default>Plone Security Team</default>
       </value_type>
    </field>

    <field name="fixed_by"
           type="zope.schema.List"
    >
      <title>Fixed by</title>
      <description i18n:translate="">Who fixed this (one per line)</description>
      <value_type type="zope.schema.TextLine">
        <default>Plone Security Team</default>
      </value_type>
    </field>

    <field name="coordinated_by"
           type="zope.schema.List"
    >
      <title>Coordinated by</title>
      <description i18n:translate="">who coordinated this (one per line)</description>
      <value_type type="zope.schema.TextLine">
        <default>Plone Security Team</default>
      </value_type>
    </field>

    <field name="cve_id"
           type="zope.schema.TextLine"
           form:mode="z3c.form.interfaces.IAddForm:input z3c.form.interfaces.IEditForm:input"
    >
      <title i18n:translate="">CVE Identifier</title>
      <description i18n:translate="">Assigned CVE identifier</description>
      <required>False</required>
    </field>

  <field name="affected_versions"
         type="zope.schema.List"
         form:widget="z3c.formwidget.optgroup.widget.OptgroupFieldWidget"
         form:params="size=15"
  >
    <title>Affected Versions</title>
    <description i18n:translate="">Assigned Versions of the Framework</description>
    <value_type type="zope.schema.Choice">
      <vocabulary>ploneorg.releasesecurityinfo.versions</vocabulary>
    </value_type>
  </field>

  <fieldset name="cvss"
            label="CVSS Scoring"
  >

    <field name="cvss_access_vector"
           type="zope.schema.Choice"
    >
      <description>This metric reflects how the vulnerability is exploited. The more remote an attacker can be to attack a host, the greater the vulnerability score</description>
      <title>Access Vector</title>
      <required>False</required>
      <vocabulary>ploneorg.releasesecurityinfo.AccessVectorVocabulary</vocabulary>
    </field>

    <field name="cvss_access_complexity"
           type="zope.schema.Choice"
    >
      <title>Access Complexity</title>
      <description>This metric measures the complexity of the attack required to exploit the vulnerability once an attacker has gained access to the target system. For example, consider a buffer overflow in an Internet service: once the target system is located, the attacker can launch an exploit at will. Other vulnerabilities, however, may require additional steps in order to be exploited. For example, a vulnerability in an email client is only exploited after the user downloads and opens a tainted attachment. The possible values for this metric are listed in Table 2. The lower the required complexity, the higher the vulnerability score.</description>
      <required>False</required>
      <vocabulary>ploneorg.releasesecurityinfo.ComplexityVocabulary</vocabulary>
    </field>

    <field name="cvss_authentication"
           type="zope.schema.Choice"
    >
      <title>Authentication</title>
      <description>This metric measures the number of times an attacker must authenticate to a target in order to exploit a vulnerability. This metric does not gauge the strength or complexity of the authentication process, only that an attacker is required to provide credentials before an exploit may occur. The fewer authentication instances that are required, the higher the vulnerability score.</description>
      <required>False</required>
      <vocabulary>ploneorg.releasesecurityinfo.AuthenticationVocabulary</vocabulary>
    </field>

    <field name="cvss_confidentiality_impact" type="zope.schema.Choice"
         >
      <title>Confidentiality Impact</title>
      <description>This metric measures the impact on confidentiality of a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones. Increased confidentiality impact increases the vulnerability score.</description>
      <required>False</required>
      <vocabulary>ploneorg.releasesecurityinfo.ImpactVocabulary</vocabulary>
    </field>

    <field name="cvss_integrity_impact"
           type="zope.schema.Choice"
    >
      <title>Integrity Impact</title>
      <description>This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and guaranteed veracity of information. Increased integrity impact increases the vulnerability score.</description>
      <required>False</required>
      <vocabulary>ploneorg.releasesecurityinfo.ImpactVocabulary</vocabulary>
    </field>

    <field name="scvss_integrity_impact"
           type="zope.schema.Choice"
    >
      <title>Integrity Impact</title>
      <description>This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and guaranteed veracity of information. Increased integrity impact increases the vulnerability score.</description>
      <required>False</required>
      <vocabulary>ploneorg.releasesecurityinfo.ImpactVocabulary</vocabulary>
    </field>

    <field name="cvss_availability_impact"
           type="zope.schema.Choice"
    >
      <title>Availability Impact</title>
      <description>This metric measures the impact to availability of a successfully exploited vulnerability. Availability refers to the accessibility of information resources. Attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system. Increased availability impact increases the vulnerability score.</description>
      <required>False</required>
      <vocabulary>ploneorg.releasesecurityinfo.ImpactVocabulary</vocabulary>
    </field>

  </fieldset>

</schema>
</model>
